{
  "document": {
    "aggregate_severity": {
      "namespace": "https://access.redhat.com/security/updates/classification/",
      "text": "Moderate"
    },
    "category": "csaf_vex",
    "csaf_version": "2.0",
    "distribution": {
      "text": "Copyright Â© Red Hat, Inc. All rights reserved.",
      "tlp": {
        "label": "WHITE",
        "url": "https://www.first.org/tlp/"
      }
    },
    "lang": "en",
    "notes": [
      {
        "category": "legal_disclaimer",
        "text": "This content is licensed under the Creative Commons Attribution 4.0 International License (https://creativecommons.org/licenses/by/4.0/). If you distribute this content, or a modified version of it, you must provide attribution to Red Hat Inc. and provide a link to the original.",
        "title": "Terms of Use"
      }
    ],
    "publisher": {
      "category": "vendor",
      "contact_details": "https://access.redhat.com/security/team/contact/",
      "issuing_authority": "Red Hat Product Security is responsible for vulnerability handling across all Red Hat products and services.",
      "name": "Red Hat Product Security",
      "namespace": "https://www.redhat.com"
    },
    "references": [
      {
        "category": "self",
        "summary": "Canonical URL",
        "url": "https://security.access.redhat.com/data/csaf/v2/vex/2025/cve-2025-4166.json"
      }
    ],
    "title": "vault: Vault May Include Sensitive Data in Error Logs When Using the KV v2 Plugin",
    "tracking": {
      "current_release_date": "2025-05-05T11:15:40+00:00",
      "generator": {
        "date": "2025-05-05T11:15:40+00:00",
        "engine": {
          "name": "Red Hat SDEngine",
          "version": "4.4.3"
        }
      },
      "id": "CVE-2025-4166",
      "initial_release_date": "2025-05-02T14:57:58.710000+00:00",
      "revision_history": [
        {
          "date": "2025-05-02T14:57:58.710000+00:00",
          "number": "1",
          "summary": "Initial version"
        },
        {
          "date": "2025-05-05T10:57:02+00:00",
          "number": "2",
          "summary": "Current version"
        },
        {
          "date": "2025-05-05T11:15:40+00:00",
          "number": "3",
          "summary": "Last generated version"
        }
      ],
      "status": "final",
      "version": "3"
    }
  },
  "product_tree": {
    "branches": [
      {
        "branches": [
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Red Hat Openshift Data Foundation 4",
                "product": {
                  "name": "Red Hat Openshift Data Foundation 4",
                  "product_id": "red_hat_openshift_data_foundation_4",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:openshift_data_foundation:4"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Red Hat Openshift Data Foundation 4"
          },
          {
            "category": "product_version",
            "name": "odf4/cephcsi-rhel9",
            "product": {
              "name": "odf4/cephcsi-rhel9",
              "product_id": "odf4/cephcsi-rhel9",
              "product_identification_helper": {
                "purl": "pkg:koji/redhat/cephcsi-container"
              }
            }
          },
          {
            "category": "product_version",
            "name": "odf4/mcg-cli-rhel9",
            "product": {
              "name": "odf4/mcg-cli-rhel9",
              "product_id": "odf4/mcg-cli-rhel9",
              "product_identification_helper": {
                "purl": "pkg:koji/redhat/mcg-cli-container"
              }
            }
          },
          {
            "category": "product_version",
            "name": "odf4/mcg-rhel9-operator",
            "product": {
              "name": "odf4/mcg-rhel9-operator",
              "product_id": "odf4/mcg-rhel9-operator",
              "product_identification_helper": {
                "purl": "pkg:koji/redhat/mcg-operator-container"
              }
            }
          },
          {
            "category": "product_version",
            "name": "odf4/odf-cli-rhel9",
            "product": {
              "name": "odf4/odf-cli-rhel9",
              "product_id": "odf4/odf-cli-rhel9",
              "product_identification_helper": {
                "purl": "pkg:koji/redhat/odf-cli-container"
              }
            }
          }
        ],
        "category": "vendor",
        "name": "Red Hat"
      }
    ],
    "relationships": [
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "odf4/cephcsi-rhel9 as a component of Red Hat Openshift Data Foundation 4",
          "product_id": "red_hat_openshift_data_foundation_4:odf4/cephcsi-rhel9"
        },
        "product_reference": "odf4/cephcsi-rhel9",
        "relates_to_product_reference": "red_hat_openshift_data_foundation_4"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "odf4/mcg-cli-rhel9 as a component of Red Hat Openshift Data Foundation 4",
          "product_id": "red_hat_openshift_data_foundation_4:odf4/mcg-cli-rhel9"
        },
        "product_reference": "odf4/mcg-cli-rhel9",
        "relates_to_product_reference": "red_hat_openshift_data_foundation_4"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "odf4/mcg-rhel9-operator as a component of Red Hat Openshift Data Foundation 4",
          "product_id": "red_hat_openshift_data_foundation_4:odf4/mcg-rhel9-operator"
        },
        "product_reference": "odf4/mcg-rhel9-operator",
        "relates_to_product_reference": "red_hat_openshift_data_foundation_4"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "odf4/odf-cli-rhel9 as a component of Red Hat Openshift Data Foundation 4",
          "product_id": "red_hat_openshift_data_foundation_4:odf4/odf-cli-rhel9"
        },
        "product_reference": "odf4/odf-cli-rhel9",
        "relates_to_product_reference": "red_hat_openshift_data_foundation_4"
      }
    ]
  },
  "vulnerabilities": [
    {
      "cve": "CVE-2025-4166",
      "cwe": {
        "id": "CWE-209",
        "name": "Generation of Error Message Containing Sensitive Information"
      },
      "discovery_date": "2025-05-02T15:00:51.528150+00:00",
      "ids": [
        {
          "system_name": "Red Hat Bugzilla ID",
          "text": "2363669"
        }
      ],
      "notes": [
        {
          "category": "description",
          "text": "Vault Community and Vault Enterprise Key/Value (kv) Version 2 plugin may unintentionally expose sensitive information in server and audit logs when users submit malformed payloads during secret creation or update operations via the Vault REST API. This vulnerability, identified as CVE-2025-4166, is fixed in Vault Community 1.19.3 and Vault Enterprise 1.19.3, 1.18.9, 1.17.16, 1.16.20.",
          "title": "Vulnerability description"
        },
        {
          "category": "summary",
          "text": "vault: Vault May Include Sensitive Data in Error Logs When Using the KV v2 Plugin",
          "title": "Vulnerability summary"
        },
        {
          "category": "general",
          "text": "The CVSS score(s) listed for this vulnerability do not reflect the associated product's status, and are included for informational purposes to better understand the severity of this vulnerability.",
          "title": "CVSS score applicability"
        }
      ],
      "product_status": {
        "known_affected": [
          "red_hat_openshift_data_foundation_4:odf4/cephcsi-rhel9",
          "red_hat_openshift_data_foundation_4:odf4/mcg-cli-rhel9",
          "red_hat_openshift_data_foundation_4:odf4/mcg-rhel9-operator",
          "red_hat_openshift_data_foundation_4:odf4/odf-cli-rhel9"
        ]
      },
      "references": [
        {
          "category": "self",
          "summary": "Canonical URL",
          "url": "https://access.redhat.com/security/cve/CVE-2025-4166"
        },
        {
          "category": "external",
          "summary": "RHBZ#2363669",
          "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2363669"
        },
        {
          "category": "external",
          "summary": "https://www.cve.org/CVERecord?id=CVE-2025-4166",
          "url": "https://www.cve.org/CVERecord?id=CVE-2025-4166"
        },
        {
          "category": "external",
          "summary": "https://nvd.nist.gov/vuln/detail/CVE-2025-4166",
          "url": "https://nvd.nist.gov/vuln/detail/CVE-2025-4166"
        },
        {
          "category": "external",
          "summary": "https://discuss.hashicorp.com/t/hcsec-2025-09-vault-may-expose-sensitive-information-in-error-logs-when-processing-malformed-data-with-the-kv-v2-plugin",
          "url": "https://discuss.hashicorp.com/t/hcsec-2025-09-vault-may-expose-sensitive-information-in-error-logs-when-processing-malformed-data-with-the-kv-v2-plugin"
        }
      ],
      "release_date": "2025-05-02T14:57:58.710000+00:00",
      "remediations": [
        {
          "category": "workaround",
          "details": "Customers with the capability to search through server and audit logs for any possible exposed secrets can refer to the following snippets to aid in searching. More information on viewing audit and server logs can be found at: https://developer.hashicorp.com/vault/tutorials/monitoring/troubleshooting-vault#vault-logs",
          "product_ids": [
            "red_hat_openshift_data_foundation_4:odf4/cephcsi-rhel9",
            "red_hat_openshift_data_foundation_4:odf4/mcg-cli-rhel9",
            "red_hat_openshift_data_foundation_4:odf4/mcg-rhel9-operator",
            "red_hat_openshift_data_foundation_4:odf4/odf-cli-rhel9"
          ]
        },
        {
          "category": "none_available",
          "details": "Fix deferred",
          "product_ids": [
            "red_hat_openshift_data_foundation_4:odf4/cephcsi-rhel9",
            "red_hat_openshift_data_foundation_4:odf4/mcg-cli-rhel9",
            "red_hat_openshift_data_foundation_4:odf4/mcg-rhel9-operator",
            "red_hat_openshift_data_foundation_4:odf4/odf-cli-rhel9"
          ]
        }
      ],
      "scores": [
        {
          "cvss_v3": {
            "version": "3.1",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:U/C:H/I:N/A:N",
            "attackVector": "NETWORK",
            "attackComplexity": "LOW",
            "privilegesRequired": "HIGH",
            "userInteraction": "REQUIRED",
            "scope": "UNCHANGED",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "NONE",
            "availabilityImpact": "NONE",
            "baseScore": 4.5,
            "baseSeverity": "MEDIUM"
          },
          "products": [
            "red_hat_openshift_data_foundation_4:odf4/cephcsi-rhel9",
            "red_hat_openshift_data_foundation_4:odf4/mcg-cli-rhel9",
            "red_hat_openshift_data_foundation_4:odf4/mcg-rhel9-operator",
            "red_hat_openshift_data_foundation_4:odf4/odf-cli-rhel9"
          ]
        }
      ],
      "threats": [
        {
          "category": "impact",
          "details": "Moderate",
          "product_ids": [
            "red_hat_openshift_data_foundation_4:odf4/cephcsi-rhel9",
            "red_hat_openshift_data_foundation_4:odf4/mcg-cli-rhel9",
            "red_hat_openshift_data_foundation_4:odf4/mcg-rhel9-operator",
            "red_hat_openshift_data_foundation_4:odf4/odf-cli-rhel9"
          ]
        }
      ],
      "title": "vault: Vault May Include Sensitive Data in Error Logs When Using the KV v2 Plugin"
    }
  ]
}