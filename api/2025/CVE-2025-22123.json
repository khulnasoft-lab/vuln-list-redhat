{
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2025-04-16T00:00:00Z",
  "bugzilla": {
    "description": "kernel: f2fs: fix to avoid accessing uninitialized curseg",
    "id": "2360272",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2360272"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "5.5",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
    "status": "draft"
  },
  "iava": "",
  "cwe": "",
  "statement": "",
  "acknowledgement": "",
  "name": "CVE-2025-22123",
  "document_distribution": "",
  "details": [
    "In the Linux kernel, the following vulnerability has been resolved:\nf2fs: fix to avoid accessing uninitialized curseg\nsyzbot reports a f2fs bug as below:\nF2FS-fs (loop3): Stopped filesystem due to reason: 7\nkworker/u8:7: attempt to access beyond end of device\nBUG: unable to handle page fault for address: ffffed1604ea3dfa\nRIP: 0010:get_ckpt_valid_blocks fs/f2fs/segment.h:361 [inline]\nRIP: 0010:has_curseg_enough_space fs/f2fs/segment.h:570 [inline]\nRIP: 0010:__get_secs_required fs/f2fs/segment.h:620 [inline]\nRIP: 0010:has_not_enough_free_secs fs/f2fs/segment.h:633 [inline]\nRIP: 0010:has_enough_free_secs+0x575/0x1660 fs/f2fs/segment.h:649\n\u003cTASK\u003e\nf2fs_is_checkpoint_ready fs/f2fs/segment.h:671 [inline]\nf2fs_write_inode+0x425/0x540 fs/f2fs/inode.c:791\nwrite_inode fs/fs-writeback.c:1525 [inline]\n__writeback_single_inode+0x708/0x10d0 fs/fs-writeback.c:1745\nwriteback_sb_inodes+0x820/0x1360 fs/fs-writeback.c:1976\nwb_writeback+0x413/0xb80 fs/fs-writeback.c:2156\nwb_do_writeback fs/fs-writeback.c:2303 [inline]\nwb_workfn+0x410/0x1080 fs/fs-writeback.c:2343\nprocess_one_work kernel/workqueue.c:3236 [inline]\nprocess_scheduled_works+0xa66/0x1840 kernel/workqueue.c:3317\nworker_thread+0x870/0xd30 kernel/workqueue.c:3398\nkthread+0x7a9/0x920 kernel/kthread.c:464\nret_from_fork+0x4b/0x80 arch/x86/kernel/process.c:148\nret_from_fork_asm+0x1a/0x30 arch/x86/entry/entry_64.S:244\nCommit 8b10d3653735 (\"f2fs: introduce FAULT_NO_SEGMENT\") allows to trigger\nno free segment fault in allocator, then it will update curseg-\u003esegno to\nNULL_SEGNO, though, CP_ERROR_FLAG has been set, f2fs_write_inode() missed\nto check the flag, and access invalid curseg-\u003esegno directly in below call\npath, then resulting in panic:\n- f2fs_write_inode\n- f2fs_is_checkpoint_ready\n- has_enough_free_secs\n- has_not_enough_free_secs\n- __get_secs_required\n- has_curseg_enough_space\n- get_ckpt_valid_blocks\n: access invalid curseg-\u003esegno\nTo avoid this issue, let's:\n- check CP_ERROR_FLAG flag in prior to f2fs_is_checkpoint_ready() in\nf2fs_write_inode().\n- in has_curseg_enough_space(), save curseg-\u003esegno into a temp variable,\nand verify its validation before use."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2025-22123\nhttps://nvd.nist.gov/vuln/detail/CVE-2025-22123\nhttps://lore.kernel.org/linux-cve-announce/2025041628-CVE-2025-22123-5ca9@gregkh/T"
  ]
}