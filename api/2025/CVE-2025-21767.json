{
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Out of support scope",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Out of support scope",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Out of support scope",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2025-02-27T00:00:00Z",
  "bugzilla": {
    "description": "kernel: clocksource: Use migrate_disable() to avoid calling get_random_u32() in atomic context",
    "id": "2348553",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2348553"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "4.4",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:N/I:N/A:H",
    "status": "draft"
  },
  "iava": "",
  "cwe": "CWE-662",
  "statement": "",
  "acknowledgement": "",
  "name": "CVE-2025-21767",
  "document_distribution": "",
  "details": [
    "In the Linux kernel, the following vulnerability has been resolved:\nclocksource: Use migrate_disable() to avoid calling get_random_u32() in atomic context\nThe following bug report happened with a PREEMPT_RT kernel:\nBUG: sleeping function called from invalid context at kernel/locking/spinlock_rt.c:48\nin_atomic(): 1, irqs_disabled(): 0, non_block: 0, pid: 2012, name: kwatchdog\npreempt_count: 1, expected: 0\nRCU nest depth: 0, expected: 0\nget_random_u32+0x4f/0x110\nclocksource_verify_choose_cpus+0xab/0x1a0\nclocksource_verify_percpu.part.0+0x6b/0x330\nclocksource_watchdog_kthread+0x193/0x1a0\nIt is due to the fact that clocksource_verify_choose_cpus() is invoked with\npreemption disabled.  This function invokes get_random_u32() to obtain\nrandom numbers for choosing CPUs.  The batched_entropy_32 local lock and/or\nthe base_crng.lock spinlock in driver/char/random.c will be acquired during\nthe call. In PREEMPT_RT kernel, they are both sleeping locks and so cannot\nbe acquired in atomic context.\nFix this problem by using migrate_disable() to allow smp_processor_id() to\nbe reliably used without introducing atomic context. preempt_disable() is\nthen called after clocksource_verify_choose_cpus() but before the\nclocksource measurement is being run to avoid introducing unexpected\nlatency.",
    "A vulnerability was found in the Linux kernel's clocksource subsystem, specifically affecting systems running with the PREEMPT_RT (Real-Time) patch. In real-time kernels, certain locks used within the random number generation functions, are implemented as sleeping locks. Calling these functions in an atomic context—where sleeping is not allowed—can lead to kernel warnings or crashes. The issue occurs when the get_random_u32() function is called within an atomic context, which is not permissible in real-time kernels due to the use of sleeping locks in the random number generation code."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2025-21767\nhttps://nvd.nist.gov/vuln/detail/CVE-2025-21767\nhttps://lore.kernel.org/linux-cve-announce/2025022605-CVE-2025-21767-4c7f@gregkh/T"
  ]
}