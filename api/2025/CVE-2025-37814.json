{
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Out of support scope",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Out of support scope",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2025-05-08T00:00:00Z",
  "bugzilla": {
    "description": "kernel: tty: Require CAP_SYS_ADMIN for all usages of TIOCL_SELMOUSEREPORT",
    "id": "2365009",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2365009"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "7.0",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H",
    "status": "draft"
  },
  "iava": "",
  "cwe": "",
  "statement": "",
  "acknowledgement": "",
  "name": "CVE-2025-37814",
  "document_distribution": "",
  "details": [
    "In the Linux kernel, the following vulnerability has been resolved:\ntty: Require CAP_SYS_ADMIN for all usages of TIOCL_SELMOUSEREPORT\nThis requirement was overeagerly loosened in commit 2f83e38a095f\n(\"tty: Permit some TIOCL_SETSEL modes without CAP_SYS_ADMIN\"), but as\nit turns out,\n(1) the logic I implemented there was inconsistent (apologies!),\n(2) TIOCL_SELMOUSEREPORT might actually be a small security risk\nafter all, and\n(3) TIOCL_SELMOUSEREPORT is only meant to be used by the mouse\ndaemon (GPM or Consolation), which runs as CAP_SYS_ADMIN\nalready.\nIn more detail:\n1. The previous patch has inconsistent logic:\nIn commit 2f83e38a095f (\"tty: Permit some TIOCL_SETSEL modes\nwithout CAP_SYS_ADMIN\"), we checked for sel_mode ==\nTIOCL_SELMOUSEREPORT, but overlooked that the lower four bits of\nthis \"mode\" parameter were actually used as an additional way to\npass an argument.  So the patch did actually still require\nCAP_SYS_ADMIN, if any of the mouse button bits are set, but did not\nrequire it if none of the mouse buttons bits are set.\nThis logic is inconsistent and was not intentional.  We should have\nthe same policies for using TIOCL_SELMOUSEREPORT independent of the\nvalue of the \"hidden\" mouse button argument.\nI sent a separate documentation patch to the man page list with\nmore details on TIOCL_SELMOUSEREPORT:\nhttps://lore.kernel.org/all/20250223091342.35523-2-gnoack3000@gmail.com/\n2. TIOCL_SELMOUSEREPORT is indeed a potential security risk which can\nlet an attacker simulate \"keyboard\" input to command line\napplications on the same terminal, like TIOCSTI and some other\nTIOCLINUX \"selection mode\" IOCTLs.\nBy enabling mouse reporting on a terminal and then injecting mouse\nreports through TIOCL_SELMOUSEREPORT, an attacker can simulate\nmouse movements on the same terminal, similar to the TIOCSTI\nkeystroke injection attacks that were previously possible with\nTIOCSTI and other TIOCL_SETSEL selection modes.\nMany programs (including libreadline/bash) are then prone to\nmisinterpret these mouse reports as normal keyboard input because\nthey do not expect input in the X11 mouse protocol form.  The\nattacker does not have complete control over the escape sequence,\nbut they can at least control the values of two consecutive bytes\nin the binary mouse reporting escape sequence.\nI went into more detail on that in the discussion at\nhttps://lore.kernel.org/all/20250221.0a947528d8f3@gnoack.org/\nIt is not equally trivial to simulate arbitrary keystrokes as it\nwas with TIOCSTI (commit 83efeeeb3d04 (\"tty: Allow TIOCSTI to be\ndisabled\")), but the general mechanism is there, and together with\nthe small number of existing legit use cases (see below), it would\nbe better to revert back to requiring CAP_SYS_ADMIN for\nTIOCL_SELMOUSEREPORT, as it was already the case before\ncommit 2f83e38a095f (\"tty: Permit some TIOCL_SETSEL modes without\nCAP_SYS_ADMIN\").\n3. TIOCL_SELMOUSEREPORT is only used by the mouse daemons (GPM or\nConsolation), and they are the only legit use case:\nTo quote console_codes(4):\nThe mouse tracking facility is intended to return\nxterm(1)-compatible mouse status reports.  Because the console\ndriver has no way to know the device or type of the mouse, these\nreports are returned in the console input stream only when the\nvirtual terminal driver receives a mouse update ioctl.  These\nioctls must be generated by a mouse-aware user-mode application\nsuch as the gpm(8) daemon.\nJared Finder has also confirmed in\nhttps://lore.kernel.org/all/491f3df9de6593df8e70dbe77614b026@finder.org/\nthat Emacs does not call TIOCL_SELMOUSEREPORT directly, and it\nwould be difficult to find good reasons for doing that, given that\nit would interfere with the reports that GPM is sending.\nMore information on the interaction between GPM, terminals and th\n---truncated---"
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2025-37814\nhttps://nvd.nist.gov/vuln/detail/CVE-2025-37814\nhttps://lore.kernel.org/linux-cve-announce/2025050818-CVE-2025-37814-ae46@gregkh/T"
  ]
}