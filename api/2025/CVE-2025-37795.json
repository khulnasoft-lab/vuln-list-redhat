{
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Out of support scope",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Out of support scope",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Out of support scope",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Out of support scope",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Out of support scope",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Fix deferred",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Fix deferred",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2025-05-01T00:00:00Z",
  "bugzilla": {
    "description": "kernel: wifi: mac80211: Update skb's control block key in ieee80211_tx_dequeue()",
    "id": "2363286",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2363286"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "5.5",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
    "status": "draft"
  },
  "iava": "",
  "cwe": "",
  "statement": "",
  "acknowledgement": "",
  "name": "CVE-2025-37795",
  "document_distribution": "",
  "details": [
    "In the Linux kernel, the following vulnerability has been resolved:\nwifi: mac80211: Update skb's control block key in ieee80211_tx_dequeue()\nThe ieee80211 skb control block key (set when skb was queued) could have\nbeen removed before ieee80211_tx_dequeue() call. ieee80211_tx_dequeue()\nalready called ieee80211_tx_h_select_key() to get the current key, but\nthe latter do not update the key in skb control block in case it is\nNULL. Because some drivers actually use this key in their TX callbacks\n(e.g. ath1{1,2}k_mac_op_tx()) this could lead to the use after free\nbelow:\nBUG: KASAN: slab-use-after-free in ath11k_mac_op_tx+0x590/0x61c\nRead of size 4 at addr ffffff803083c248 by task kworker/u16:4/1440\nCPU: 3 UID: 0 PID: 1440 Comm: kworker/u16:4 Not tainted 6.13.0-ge128f627f404 #2\nHardware name: HW (DT)\nWorkqueue: bat_events batadv_send_outstanding_bcast_packet\nCall trace:\nshow_stack+0x14/0x1c (C)\ndump_stack_lvl+0x58/0x74\nprint_report+0x164/0x4c0\nkasan_report+0xac/0xe8\n__asan_report_load4_noabort+0x1c/0x24\nath11k_mac_op_tx+0x590/0x61c\nieee80211_handle_wake_tx_queue+0x12c/0x1c8\nieee80211_queue_skb+0xdcc/0x1b4c\nieee80211_tx+0x1ec/0x2bc\nieee80211_xmit+0x224/0x324\n__ieee80211_subif_start_xmit+0x85c/0xcf8\nieee80211_subif_start_xmit+0xc0/0xec4\ndev_hard_start_xmit+0xf4/0x28c\n__dev_queue_xmit+0x6ac/0x318c\nbatadv_send_skb_packet+0x38c/0x4b0\nbatadv_send_outstanding_bcast_packet+0x110/0x328\nprocess_one_work+0x578/0xc10\nworker_thread+0x4bc/0xc7c\nkthread+0x2f8/0x380\nret_from_fork+0x10/0x20\nAllocated by task 1906:\nkasan_save_stack+0x28/0x4c\nkasan_save_track+0x1c/0x40\nkasan_save_alloc_info+0x3c/0x4c\n__kasan_kmalloc+0xac/0xb0\n__kmalloc_noprof+0x1b4/0x380\nieee80211_key_alloc+0x3c/0xb64\nieee80211_add_key+0x1b4/0x71c\nnl80211_new_key+0x2b4/0x5d8\ngenl_family_rcv_msg_doit+0x198/0x240\n\u003c...\u003e\nFreed by task 1494:\nkasan_save_stack+0x28/0x4c\nkasan_save_track+0x1c/0x40\nkasan_save_free_info+0x48/0x94\n__kasan_slab_free+0x48/0x60\nkfree+0xc8/0x31c\nkfree_sensitive+0x70/0x80\nieee80211_key_free_common+0x10c/0x174\nieee80211_free_keys+0x188/0x46c\nieee80211_stop_mesh+0x70/0x2cc\nieee80211_leave_mesh+0x1c/0x60\ncfg80211_leave_mesh+0xe0/0x280\ncfg80211_leave+0x1e0/0x244\n\u003c...\u003e\nReset SKB control block key before calling ieee80211_tx_h_select_key()\nto avoid that."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2025-37795\nhttps://nvd.nist.gov/vuln/detail/CVE-2025-37795\nhttps://lore.kernel.org/linux-cve-announce/2025050121-CVE-2025-37795-1049@gregkh/T"
  ]
}