{
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Out of support scope",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Out of support scope",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Out of support scope",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Out of support scope",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Out of support scope",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Fix deferred",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Fix deferred",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2025-05-01T00:00:00Z",
  "bugzilla": {
    "description": "kernel: wifi: mac80211: Purge vif txq in ieee80211_do_stop()",
    "id": "2363344",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2363344"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "5.5",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
    "status": "draft"
  },
  "iava": "",
  "cwe": "",
  "statement": "",
  "acknowledgement": "",
  "name": "CVE-2025-37794",
  "document_distribution": "",
  "details": [
    "In the Linux kernel, the following vulnerability has been resolved:\nwifi: mac80211: Purge vif txq in ieee80211_do_stop()\nAfter ieee80211_do_stop() SKB from vif's txq could still be processed.\nIndeed another concurrent vif schedule_and_wake_txq call could cause\nthose packets to be dequeued (see ieee80211_handle_wake_tx_queue())\nwithout checking the sdata current state.\nBecause vif.drv_priv is now cleared in this function, this could lead to\ndriver crash.\nFor example in ath12k, ahvif is store in vif.drv_priv. Thus if\nath12k_mac_op_tx() is called after ieee80211_do_stop(), ahvif-\u003eah can be\nNULL, leading the ath12k_warn(ahvif-\u003eah,...) call in this function to\ntrigger the NULL deref below.\nUnable to handle kernel paging request at virtual address dfffffc000000001\nKASAN: null-ptr-deref in range [0x0000000000000008-0x000000000000000f]\nbatman_adv: bat0: Interface deactivated: brbh1337\nMem abort info:\nESR = 0x0000000096000004\nEC = 0x25: DABT (current EL), IL = 32 bits\nSET = 0, FnV = 0\nEA = 0, S1PTW = 0\nFSC = 0x04: level 0 translation fault\nData abort info:\nISV = 0, ISS = 0x00000004, ISS2 = 0x00000000\nCM = 0, WnR = 0, TnD = 0, TagAccess = 0\nGCS = 0, Overlay = 0, DirtyBit = 0, Xs = 0\n[dfffffc000000001] address between user and kernel address ranges\nInternal error: Oops: 0000000096000004 [#1] SMP\nCPU: 1 UID: 0 PID: 978 Comm: lbd Not tainted 6.13.0-g633f875b8f1e #114\nHardware name: HW (DT)\npstate: 10000005 (nzcV daif -PAN -UAO -TCO -DIT -SSBS BTYPE=--)\npc : ath12k_mac_op_tx+0x6cc/0x29b8 [ath12k]\nlr : ath12k_mac_op_tx+0x174/0x29b8 [ath12k]\nsp : ffffffc086ace450\nx29: ffffffc086ace450 x28: 0000000000000000 x27: 1ffffff810d59ca4\nx26: ffffff801d05f7c0 x25: 0000000000000000 x24: 000000004000001e\nx23: ffffff8009ce4926 x22: ffffff801f9c0800 x21: ffffff801d05f7f0\nx20: ffffff8034a19f40 x19: 0000000000000000 x18: ffffff801f9c0958\nx17: ffffff800bc0a504 x16: dfffffc000000000 x15: ffffffc086ace4f8\nx14: ffffff801d05f83c x13: 0000000000000000 x12: ffffffb003a0bf03\nx11: 0000000000000000 x10: ffffffb003a0bf02 x9 : ffffff8034a19f40\nx8 : ffffff801d05f818 x7 : 1ffffff0069433dc x6 : ffffff8034a19ee0\nx5 : ffffff801d05f7f0 x4 : 0000000000000000 x3 : 0000000000000001\nx2 : 0000000000000000 x1 : dfffffc000000000 x0 : 0000000000000008\nCall trace:\nath12k_mac_op_tx+0x6cc/0x29b8 [ath12k] (P)\nieee80211_handle_wake_tx_queue+0x16c/0x260\nieee80211_queue_skb+0xeec/0x1d20\nieee80211_tx+0x200/0x2c8\nieee80211_xmit+0x22c/0x338\n__ieee80211_subif_start_xmit+0x7e8/0xc60\nieee80211_subif_start_xmit+0xc4/0xee0\n__ieee80211_subif_start_xmit_8023.isra.0+0x854/0x17a0\nieee80211_subif_start_xmit_8023+0x124/0x488\ndev_hard_start_xmit+0x160/0x5a8\n__dev_queue_xmit+0x6f8/0x3120\nbr_dev_queue_push_xmit+0x120/0x4a8\n__br_forward+0xe4/0x2b0\ndeliver_clone+0x5c/0xd0\nbr_flood+0x398/0x580\nbr_dev_xmit+0x454/0x9f8\ndev_hard_start_xmit+0x160/0x5a8\n__dev_queue_xmit+0x6f8/0x3120\nip6_finish_output2+0xc28/0x1b60\n__ip6_finish_output+0x38c/0x638\nip6_output+0x1b4/0x338\nip6_local_out+0x7c/0xa8\nip6_send_skb+0x7c/0x1b0\nip6_push_pending_frames+0x94/0xd0\nrawv6_sendmsg+0x1a98/0x2898\ninet_sendmsg+0x94/0xe0\n__sys_sendto+0x1e4/0x308\n__arm64_sys_sendto+0xc4/0x140\ndo_el0_svc+0x110/0x280\nel0_svc+0x20/0x60\nel0t_64_sync_handler+0x104/0x138\nel0t_64_sync+0x154/0x158\nTo avoid that, empty vif's txq at ieee80211_do_stop() so no packet could\nbe dequeued after ieee80211_do_stop() (new packets cannot be queued\nbecause SDATA_STATE_RUNNING is cleared at this point)."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2025-37794\nhttps://nvd.nist.gov/vuln/detail/CVE-2025-37794\nhttps://lore.kernel.org/linux-cve-announce/2025050121-CVE-2025-37794-0a39@gregkh/T"
  ]
}