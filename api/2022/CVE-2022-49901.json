{
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Out of support scope",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Out of support scope",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Out of support scope",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Out of support scope",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Fix deferred",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Fix deferred",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2025-05-01T00:00:00Z",
  "bugzilla": {
    "description": "kernel: blk-mq: Fix kmemleak in blk_mq_init_allocated_queue",
    "id": "2363450",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2363450"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "5.5",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
    "status": "draft"
  },
  "iava": "",
  "cwe": "",
  "statement": "",
  "acknowledgement": "",
  "name": "CVE-2022-49901",
  "document_distribution": "",
  "details": [
    "In the Linux kernel, the following vulnerability has been resolved:\nblk-mq: Fix kmemleak in blk_mq_init_allocated_queue\nThere is a kmemleak caused by modprobe null_blk.ko\nunreferenced object 0xffff8881acb1f000 (size 1024):\ncomm \"modprobe\", pid 836, jiffies 4294971190 (age 27.068s)\nhex dump (first 32 bytes):\n00 00 00 00 ad 4e ad de ff ff ff ff 00 00 00 00  .....N..........\nff ff ff ff ff ff ff ff 00 53 99 9e ff ff ff ff  .........S......\nbacktrace:\n[\u003c000000004a10c249\u003e] kmalloc_node_trace+0x22/0x60\n[\u003c00000000648f7950\u003e] blk_mq_alloc_and_init_hctx+0x289/0x350\n[\u003c00000000af06de0e\u003e] blk_mq_realloc_hw_ctxs+0x2fe/0x3d0\n[\u003c00000000e00c1872\u003e] blk_mq_init_allocated_queue+0x48c/0x1440\n[\u003c00000000d16b4e68\u003e] __blk_mq_alloc_disk+0xc8/0x1c0\n[\u003c00000000d10c98c3\u003e] 0xffffffffc450d69d\n[\u003c00000000b9299f48\u003e] 0xffffffffc4538392\n[\u003c0000000061c39ed6\u003e] do_one_initcall+0xd0/0x4f0\n[\u003c00000000b389383b\u003e] do_init_module+0x1a4/0x680\n[\u003c0000000087cf3542\u003e] load_module+0x6249/0x7110\n[\u003c00000000beba61b8\u003e] __do_sys_finit_module+0x140/0x200\n[\u003c00000000fdcfff51\u003e] do_syscall_64+0x35/0x80\n[\u003c000000003c0f1f71\u003e] entry_SYSCALL_64_after_hwframe+0x46/0xb0\nThat is because q-\u003ema_ops is set to NULL before blk_release_queue is\ncalled.\nblk_mq_init_queue_data\nblk_mq_init_allocated_queue\nblk_mq_realloc_hw_ctxs\nfor (i = 0; i \u003c set-\u003enr_hw_queues; i++) {\nold_hctx = xa_load(\u0026q-\u003ehctx_table, i);\nif (!blk_mq_alloc_and_init_hctx(.., i, ..))[1]\nif (!old_hctx)\nbreak;\nxa_for_each_start(\u0026q-\u003ehctx_table, j, hctx, j)\nblk_mq_exit_hctx(q, set, hctx, j); [2]\nif (!q-\u003enr_hw_queues)[3]\ngoto err_hctxs;\nerr_exit:\nq-\u003emq_ops = NULL;  [4]\nblk_put_queue\nblk_release_queue\nif (queue_is_mq(q))[5]\nblk_mq_release(q);\n[1]: blk_mq_alloc_and_init_hctx failed at i != 0.\n[2]: The hctxs allocated by [1] are moved to q-\u003eunused_hctx_list and\nwill be cleaned up in blk_mq_release.\n[3]: q-\u003enr_hw_queues is 0.\n[4]: Set q-\u003emq_ops to NULL.\n[5]: queue_is_mq returns false due to [4]. And blk_mq_release\nwill not be called. The hctxs in q-\u003eunused_hctx_list are leaked.\nTo fix it, call blk_release_queue in exception path."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2022-49901\nhttps://nvd.nist.gov/vuln/detail/CVE-2022-49901\nhttps://lore.kernel.org/linux-cve-announce/2025050101-CVE-2022-49901-1130@gregkh/T"
  ]
}