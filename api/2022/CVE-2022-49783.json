{
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Out of support scope",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Out of support scope",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Fix deferred",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Fix deferred",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2025-05-01T00:00:00Z",
  "bugzilla": {
    "description": "kernel: x86/fpu: Drop fpregs lock before inheriting FPU permissions",
    "id": "2363405",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2363405"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "5.5",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
    "status": "draft"
  },
  "iava": "",
  "cwe": "",
  "statement": "",
  "acknowledgement": "",
  "name": "CVE-2022-49783",
  "document_distribution": "",
  "details": [
    "In the Linux kernel, the following vulnerability has been resolved:\nx86/fpu: Drop fpregs lock before inheriting FPU permissions\nMike Galbraith reported the following against an old fork of preempt-rt\nbut the same issue also applies to the current preempt-rt tree.\nBUG: sleeping function called from invalid context at kernel/locking/spinlock_rt.c:46\nin_atomic(): 1, irqs_disabled(): 0, non_block: 0, pid: 1, name: systemd\npreempt_count: 1, expected: 0\nRCU nest depth: 0, expected: 0\nPreemption disabled at:\nfpu_clone\nCPU: 6 PID: 1 Comm: systemd Tainted: G            E       (unreleased)\nCall Trace:\n\u003cTASK\u003e\ndump_stack_lvl\n? fpu_clone\n__might_resched\nrt_spin_lock\nfpu_clone\n? copy_thread\n? copy_process\n? shmem_alloc_inode\n? kmem_cache_alloc\n? kernel_clone\n? __do_sys_clone\n? do_syscall_64\n? __x64_sys_rt_sigprocmask\n? syscall_exit_to_user_mode\n? do_syscall_64\n? syscall_exit_to_user_mode\n? do_syscall_64\n? syscall_exit_to_user_mode\n? do_syscall_64\n? exc_page_fault\n? entry_SYSCALL_64_after_hwframe\n\u003c/TASK\u003e\nMike says:\nThe splat comes from fpu_inherit_perms() being called under fpregs_lock(),\nand us reaching the spin_lock_irq() therein due to fpu_state_size_dynamic()\nreturning true despite static key __fpu_state_size_dynamic having never\nbeen enabled.\nMike's assessment looks correct. fpregs_lock on a PREEMPT_RT kernel disables\npreemption so calling spin_lock_irq() in fpu_inherit_perms() is unsafe. This\nproblem exists since commit\n9e798e9aa14c (\"x86/fpu: Prepare fpu_clone() for dynamically enabled features\").\nEven though the original bug report should not have enabled the paths at\nall, the bug still exists.\nfpregs_lock is necessary when editing the FPU registers or a task's FP\nstate but it is not necessary for fpu_inherit_perms(). The only write\nof any FP state in fpu_inherit_perms() is for the new child which is\nnot running yet and cannot context switch or be borrowed by a kernel\nthread yet. Hence, fpregs_lock is not protecting anything in the new\nchild until clone() completes and can be dropped earlier. The siglock\nstill needs to be acquired by fpu_inherit_perms() as the read of the\nparent's permissions has to be serialised.\n[ bp: Cleanup splat. ]"
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2022-49783\nhttps://nvd.nist.gov/vuln/detail/CVE-2022-49783\nhttps://lore.kernel.org/linux-cve-announce/2025050120-CVE-2022-49783-a870@gregkh/T"
  ]
}