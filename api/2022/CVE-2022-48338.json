{
  "affected_release": [
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "release_date": "2023-05-09T00:00:00Z",
      "advisory": "RHSA-2023:2626",
      "package": "emacs-1:27.2-8.el9_2.1",
      "cpe": "cpe:/a:redhat:enterprise_linux:9"
    }
  ],
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Out of support scope",
      "package_name": "emacs",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Affected",
      "package_name": "emacs",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Affected",
      "package_name": "emacs",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2023-02-21T00:00:00Z",
  "bugzilla": {
    "description": "emacs: local command injection in ruby-mode.el",
    "id": "2171988",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2171988"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "7.3",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H",
    "status": "verified"
  },
  "iava": "",
  "cwe": "CWE-77",
  "statement": "This vulnerability is only triggered when a local user runs Emacs with untrusted input. For this reason, this flaw has been rated with a Moderate security impact.\nWithin regulated environments, a combination of the following controls acts as a significant barrier to successfully exploiting a CWE-77: Improper Neutralization of Special Elements used in a Command ('Command Injection') vulnerability and therefore downgrades the severity of this particular CVE from Moderate to Low.\nSecure baseline configurations were established during the initial design of the system architecture and security boundary. Static code testing (SAST, DAST) is conducted before entry into the environment. CI/CD configurations help to restrict the use of commands or scripts that could be exploited by command injection and are coupled with a two-person review for all manual code promotions. The attack surface is limited through least privilege and least functionality enforcement, ensuring only authorized personnel can carry out these tasks and that only essential services and ports are enabled. Input validation is performed for all services or features within the system boundary, reducing the risk of improper input handling or command injection. Additionally, malicious code protection and system monitoring work together to minimize potential impacts by detecting, blocking, and responding in the case of successful exploitation.",
  "acknowledgement": "",
  "name": "CVE-2022-48338",
  "document_distribution": "",
  "details": [
    "An issue was discovered in GNU Emacs through 28.2. In ruby-mode.el, the ruby-find-library-file function has a local command injection vulnerability. The ruby-find-library-file function is an interactive function, and bound to C-c C-f. Inside the function, the external command gem is called through shell-command-to-string, but the feature-name parameters are not escaped. Thus, malicious Ruby source files may cause commands to be executed.",
    "A flaw was found in the Emacs package. A malicious ruby source file may cause a local command injection."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2022-48338\nhttps://nvd.nist.gov/vuln/detail/CVE-2022-48338"
  ]
}