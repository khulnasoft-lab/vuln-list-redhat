{
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Not affected",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Fix deferred",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Fix deferred",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2025-05-01T00:00:00Z",
  "bugzilla": {
    "description": "kernel: tracing: kprobe: Fix memory leak in test_gen_kprobe/kretprobe_cmd()",
    "id": "2363526",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2363526"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "5.5",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
    "status": "draft"
  },
  "iava": "",
  "cwe": "",
  "statement": "",
  "acknowledgement": "",
  "name": "CVE-2022-49891",
  "document_distribution": "",
  "details": [
    "In the Linux kernel, the following vulnerability has been resolved:\ntracing: kprobe: Fix memory leak in test_gen_kprobe/kretprobe_cmd()\ntest_gen_kprobe_cmd() only free buf in fail path, hence buf will leak\nwhen there is no failure. Move kfree(buf) from fail path to common path\nto prevent the memleak. The same reason and solution in\ntest_gen_kretprobe_cmd().\nunreferenced object 0xffff888143b14000 (size 2048):\ncomm \"insmod\", pid 52490, jiffies 4301890980 (age 40.553s)\nhex dump (first 32 bytes):\n70 3a 6b 70 72 6f 62 65 73 2f 67 65 6e 5f 6b 70  p:kprobes/gen_kp\n72 6f 62 65 5f 74 65 73 74 20 64 6f 5f 73 79 73  robe_test do_sys\nbacktrace:\n[\u003c000000006d7b836b\u003e] kmalloc_trace+0x27/0xa0\n[\u003c0000000009528b5b\u003e] 0xffffffffa059006f\n[\u003c000000008408b580\u003e] do_one_initcall+0x87/0x2a0\n[\u003c00000000c4980a7e\u003e] do_init_module+0xdf/0x320\n[\u003c00000000d775aad0\u003e] load_module+0x3006/0x3390\n[\u003c00000000e9a74b80\u003e] __do_sys_finit_module+0x113/0x1b0\n[\u003c000000003726480d\u003e] do_syscall_64+0x35/0x80\n[\u003c000000003441e93b\u003e] entry_SYSCALL_64_after_hwframe+0x46/0xb0"
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2022-49891\nhttps://nvd.nist.gov/vuln/detail/CVE-2022-49891\nhttps://lore.kernel.org/linux-cve-announce/2025050158-CVE-2022-49891-67cc@gregkh/T"
  ]
}