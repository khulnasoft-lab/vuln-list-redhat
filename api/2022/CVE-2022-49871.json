{
  "affected_release": null,
  "package_state": [
    {
      "product_name": "Red Hat Enterprise Linux 6",
      "fix_state": "Out of support scope",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:6"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Out of support scope",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 7",
      "fix_state": "Out of support scope",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:7"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Out of support scope",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 8",
      "fix_state": "Out of support scope",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:8"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Fix deferred",
      "package_name": "kernel",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    },
    {
      "product_name": "Red Hat Enterprise Linux 9",
      "fix_state": "Fix deferred",
      "package_name": "kernel-rt",
      "cpe": "cpe:/o:redhat:enterprise_linux:9"
    }
  ],
  "threat_severity": "Moderate",
  "public_date": "2025-05-01T00:00:00Z",
  "bugzilla": {
    "description": "kernel: net: tun: Fix memory leaks of napi_get_frags",
    "id": "2363464",
    "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2363464"
  },
  "cvss": {
    "cvss_base_score": "",
    "cvss_scoring_vector": "",
    "status": ""
  },
  "cvss3": {
    "cvss3_base_score": "5.5",
    "cvss3_scoring_vector": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
    "status": "draft"
  },
  "iava": "",
  "cwe": "",
  "statement": "",
  "acknowledgement": "",
  "name": "CVE-2022-49871",
  "document_distribution": "",
  "details": [
    "In the Linux kernel, the following vulnerability has been resolved:\nnet: tun: Fix memory leaks of napi_get_frags\nkmemleak reports after running test_progs:\nunreferenced object 0xffff8881b1672dc0 (size 232):\ncomm \"test_progs\", pid 394388, jiffies 4354712116 (age 841.975s)\nhex dump (first 32 bytes):\ne0 84 d7 a8 81 88 ff ff 80 2c 67 b1 81 88 ff ff  .........,g.....\n00 40 c5 9b 81 88 ff ff 00 00 00 00 00 00 00 00  .@..............\nbacktrace:\n[\u003c00000000c8f01748\u003e] napi_skb_cache_get+0xd4/0x150\n[\u003c0000000041c7fc09\u003e] __napi_build_skb+0x15/0x50\n[\u003c00000000431c7079\u003e] __napi_alloc_skb+0x26e/0x540\n[\u003c000000003ecfa30e\u003e] napi_get_frags+0x59/0x140\n[\u003c0000000099b2199e\u003e] tun_get_user+0x183d/0x3bb0 [tun]\n[\u003c000000008a5adef0\u003e] tun_chr_write_iter+0xc0/0x1b1 [tun]\n[\u003c0000000049993ff4\u003e] do_iter_readv_writev+0x19f/0x320\n[\u003c000000008f338ea2\u003e] do_iter_write+0x135/0x630\n[\u003c000000008a3377a4\u003e] vfs_writev+0x12e/0x440\n[\u003c00000000a6b5639a\u003e] do_writev+0x104/0x280\n[\u003c00000000ccf065d8\u003e] do_syscall_64+0x3b/0x90\n[\u003c00000000d776e329\u003e] entry_SYSCALL_64_after_hwframe+0x63/0xcd\nThe issue occurs in the following scenarios:\ntun_get_user()\nnapi_gro_frags()\nnapi_frags_finish()\ncase GRO_NORMAL:\ngro_normal_one()\nlist_add_tail(\u0026skb-\u003elist, \u0026napi-\u003erx_list);\n\u003c-- While napi-\u003erx_count \u003c READ_ONCE(gro_normal_batch),\n\u003c-- gro_normal_list() is not called, napi-\u003erx_list is not empty\n\u003c-- not ask to complete the gro work, will cause memory leaks in\n\u003c-- following tun_napi_del()\n...\ntun_napi_del()\nnetif_napi_del()\n__netif_napi_del()\n\u003c-- \u0026napi-\u003erx_list is not empty, which caused memory leaks\nTo fix, add napi_complete() after napi_gro_frags()."
  ],
  "references": [
    "https://www.cve.org/CVERecord?id=CVE-2022-49871\nhttps://nvd.nist.gov/vuln/detail/CVE-2022-49871\nhttps://lore.kernel.org/linux-cve-announce/2025050151-CVE-2022-49871-619c@gregkh/T"
  ]
}