{
  "Class": "vulnerability",
  "ID": "oval:com.redhat.cve:def:201820839",
  "Version": "636",
  "Metadata": {
    "Title": "systemd: mishandling of the current keyboard mode check leading to passwords being disclosed in cleartext to attacker (moderate)",
    "References": [
      {
        "Source": "CVE",
        "RefID": "CVE-2018-20839",
        "RefURL": "https://access.redhat.com/security/cve/CVE-2018-20839"
      }
    ],
    "Description": "DOCUMENTATION: The MITRE CVE dictionary describes this issue as: systemd 242 changes the VT1 mode upon a logout, which allows attackers to read cleartext passwords in certain circumstances, such as watching a shutdown, or using Ctrl-Alt-F1 and Ctrl-Alt-F2. This occurs because the KDGKBMODE (aka current keyboard mode) check is mishandled. \n            STATEMENT: Red Hat Product Security has determined that exploiting this vulnerability requires the attacker to physically input keystrokes on the targeted system, which means the Attack Vector is Local, and User Interaction is required. The issue results in confidential information being exposed in cleartext, but it does not alter any recorded data, thereby not affecting the system's integrity. Additionally, there is no known method to disrupt the availability of the systemd daemon. Consequently, both the 'Integrity' and 'Availability' impacts are assessed as 'None.'\n\nFurther complications occur in this issue: the initial fix provided by upstream introduced a regression and was reverted. In the process of managing a new fix, other contributory issues were reported against Xorg and Plymouth. Plymouth's issue was resolved. The ostensible fix versions of systemd (v243) and Plymouth (v0.9.4) are both fixed in RHEL-9, therefore RHEL-9 has been determined to be Not Affected by this flaw. Because of uncertainties and unknowns surrounding the purported fixes, the issue will not be corrected in RHEL-8.",
    "Advisory": {
      "From": "secalert@redhat.com",
      "Severity": "Moderate",
      "Issued": {},
      "Updated": {
        "Date": "2024-10-17"
      },
      "Cves": [
        {
          "CveID": "CVE-2018-20839",
          "Cvss3": "4.3/CVSS:3.0/AV:P/AC:L/PR:N/UI:R/S:U/C:H/I:N/A:N",
          "Cwe": "CWE-200",
          "Impact": "moderate",
          "Href": "https://access.redhat.com/security/cve/CVE-2018-20839",
          "Public": "20190517"
        }
      ],
      "AffectedCpeList": [
        "cpe:/a:redhat:enterprise_linux:8",
        "cpe:/a:redhat:enterprise_linux:8::appstream",
        "cpe:/a:redhat:enterprise_linux:8::crb",
        "cpe:/a:redhat:enterprise_linux:8::highavailability",
        "cpe:/a:redhat:enterprise_linux:8::nfv",
        "cpe:/a:redhat:enterprise_linux:8::realtime",
        "cpe:/a:redhat:enterprise_linux:8::resilientstorage",
        "cpe:/a:redhat:enterprise_linux:8::sap",
        "cpe:/a:redhat:enterprise_linux:8::sap_hana",
        "cpe:/a:redhat:enterprise_linux:8::supplementary",
        "cpe:/o:redhat:enterprise_linux:8",
        "cpe:/o:redhat:enterprise_linux:8::baseos"
      ],
      "Affected": {
        "Resolution": {
          "State": "Will not fix"
        }
      }
    }
  },
  "Criteria": {
    "Operator": "OR",
    "Criterions": [
      {
        "Comment": "Red Hat Enterprise Linux must be installed",
        "TestRef": "oval:com.redhat.cve:tst:20052541004"
      }
    ],
    "Criterias": [
      {
        "Operator": "AND",
        "Criterions": [
          {
            "Comment": "Red Hat Enterprise Linux 8 is installed",
            "TestRef": "oval:com.redhat.cve:tst:20052541003"
          }
        ],
        "Criterias": [
          {
            "Operator": "OR",
            "Criterias": [
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "systemd is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201820839001"
                  },
                  {
                    "Comment": "systemd is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201820839002"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "systemd-pam is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201820839003"
                  },
                  {
                    "Comment": "systemd-pam is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201820839004"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "systemd-container is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201820839005"
                  },
                  {
                    "Comment": "systemd-container is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201820839006"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "systemd-libs is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201820839007"
                  },
                  {
                    "Comment": "systemd-libs is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201820839008"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "systemd-udev is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201820839009"
                  },
                  {
                    "Comment": "systemd-udev is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201820839010"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "systemd-journal-remote is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201820839011"
                  },
                  {
                    "Comment": "systemd-journal-remote is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201820839012"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "systemd-devel is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201820839013"
                  },
                  {
                    "Comment": "systemd-devel is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201820839014"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "systemd-tests is installed",
                    "TestRef": "oval:com.redhat.cve:tst:201820839015"
                  },
                  {
                    "Comment": "systemd-tests is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:201820839016"
                  }
                ]
              }
            ]
          }
        ]
      }
    ]
  }
}