{
  "Class": "vulnerability",
  "ID": "oval:com.redhat.cve:def:202442472",
  "Version": "636",
  "Metadata": {
    "Title": "flatpak: Access to files outside sandbox for apps using persistent= (--persist) (important)",
    "References": [
      {
        "Source": "CVE",
        "RefID": "CVE-2024-42472",
        "RefURL": "https://access.redhat.com/security/cve/CVE-2024-42472"
      }
    ],
    "Description": "DOCUMENTATION: A sandbox escape vulnerability was found in Flatpak due to a symlink-following issue when mounting persistent directories. This flaw allows a local user or attacker to craft a symbolic link that can bypass the intended restrictions, enabling access to and modification of files outside the designated sandbox. As a result, the attacker could potentially manipulate the file system, leading to unauthorized actions that compromise the security and integrity of the system. \n            STATEMENT: This vulnerability in Flatpak represents a significant severity issue due to its potential to undermine the core principles of application sandboxing, which are designed to isolate applications and protect the integrity and confidentiality of the system. By exploiting the persistent=subdir option, a malicious or compromised application can manipulate bind mounts via symlinks, thereby escaping the confines of its designated sandbox. This allows unauthorized access to the host filesystem, enabling the potential for unauthorized data manipulation, exfiltration, or system compromise. The risk is further exacerbated by the presence of a race condition, which can be exploited by running multiple instances of a malicious app concurrently.\n            MITIGATION: Mitigation for this issue is either not available or the currently available options do not meet the Red Hat Product Security criteria comprising ease of use and deployment, applicability to widespread installation base or stability.",
    "Advisory": {
      "From": "secalert@redhat.com",
      "Severity": "Important",
      "Issued": {},
      "Updated": {
        "Date": "2024-08-19"
      },
      "Cves": [
        {
          "CveID": "CVE-2024-42472",
          "Cvss3": "7.4/CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:N",
          "Cwe": "CWE-74",
          "Impact": "important",
          "Href": "https://access.redhat.com/security/cve/CVE-2024-42472",
          "Public": "20240814"
        }
      ],
      "AffectedCpeList": [
        "cpe:/a:redhat:rhel_extras:7",
        "cpe:/a:redhat:rhel_extras_oracle_java:7",
        "cpe:/a:redhat:rhel_extras_rt:7",
        "cpe:/a:redhat:rhel_extras_sap:7",
        "cpe:/a:redhat:rhel_extras_sap_hana:7",
        "cpe:/o:redhat:enterprise_linux:7",
        "cpe:/o:redhat:enterprise_linux:7::client",
        "cpe:/o:redhat:enterprise_linux:7::computenode",
        "cpe:/o:redhat:enterprise_linux:7::server",
        "cpe:/o:redhat:enterprise_linux:7::workstation"
      ],
      "Affected": {
        "Resolution": {
          "State": "Affected"
        }
      }
    }
  },
  "Criteria": {
    "Operator": "OR",
    "Criterions": [
      {
        "Comment": "Red Hat Enterprise Linux must be installed",
        "TestRef": "oval:com.redhat.cve:tst:20042779006"
      }
    ],
    "Criterias": [
      {
        "Operator": "AND",
        "Criterions": [
          {
            "Comment": "Red Hat Enterprise Linux 7 is installed",
            "TestRef": "oval:com.redhat.cve:tst:20042779005"
          }
        ],
        "Criterias": [
          {
            "Operator": "OR",
            "Criterias": [
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "flatpak-devel is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202328100005"
                  },
                  {
                    "Comment": "flatpak-devel is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202328100006"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "flatpak is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202328100003"
                  },
                  {
                    "Comment": "flatpak is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202328100004"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "flatpak-libs is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202328100001"
                  },
                  {
                    "Comment": "flatpak-libs is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202328100002"
                  }
                ]
              },
              {
                "Operator": "AND",
                "Criterions": [
                  {
                    "Comment": "flatpak-builder is installed",
                    "TestRef": "oval:com.redhat.cve:tst:202328100007"
                  },
                  {
                    "Comment": "flatpak-builder is signed with Red Hat redhatrelease2 key",
                    "TestRef": "oval:com.redhat.cve:tst:202328100008"
                  }
                ]
              }
            ]
          }
        ]
      }
    ]
  }
}